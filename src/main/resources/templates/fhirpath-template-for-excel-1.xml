<template id="test-template1b" excel-filename="generated-test-${TIMESTAMP}.xlsx">

    <container csv-filename="Patient-${TIMESTAMP}.csv" excel-sheet="Patient" order="71">
        <attribute csv-column="DKTK-ID-Global" excel-column="DKTK-ID-Global"
            fhir-path="Patient.identifier.where(type.coding.code = 'Global').value.value" order="2"/>
        <attribute csv-column="DKTK-ID-Lokal" excel-column="DKTK-ID-Lokal"
            fhir-path="Patient.identifier.where(type.coding.code = 'Lokal').value.value" order="1"/>
        <attribute csv-column="Untersuchungs-, Befunddatum im Verlauf"
            excel-column="Untersuchungs-, Befunddatum im Verlauf"
            fhir-path="ClinicalImpression.effective.value" order="1"/>
        <attribute csv-column="Tumor Diagnosedatum" excel-column="Tumor Diagnosedatum"
            fhir-path="Condition.onset.value" order="7"/>
        <attribute csv-column="Geburtsdatum" excel-column="Geburtsdatum"
            fhir-path="Patient.birthDate.value" order="4"/>
        <attribute csv-column="Datum des letztbekannten Vitalstatus"
            excel-column="Datum des letztbekannten Vitalstatus"
            fhir-path="Observation.where(code.coding.code = '75186-7').effective.value" order="1"/>
        <attribute csv-column="Geschlecht" excel-column="Geschlecht"
            fhir-path="Patient.gender.value" order="3"/>
        <attribute csv-column="Vitalstatus" excel-column="Vitalstatus"
            fhir-path="Observation.where(code.coding.code = '75186-7').value.coding.code.value"
            order="2"/>

    </container>


    <container csv-filename="Primärdiagnose-${TIMESTAMP}.csv" excel-sheet="Primärdiagnose" order="43">
        <attribute csv-column="Version des ICD-10-Katalogs"
            excel-column="Version des ICD-10-Katalogs"
            fhir-path="Condition.code.coding.version.value" order="1"/>
        <attribute csv-column="Primärdiagnose" excel-column="Primärdiagnose"
            fhir-path="Condition.code.coding.code.value" order="2"/>
        <attribute csv-column="Primaertumor Diagnosetext" excel-column="Primaertumor Diagnosetext"
            fhir-path="Condition.code.text.value" order="3"/>
        <attribute csv-column="ICD-O Katalog Topographie (Version)"
            excel-column="ICD-O Katalog Topographie (Version)"
            fhir-path="Condition.bodySite.coding.where(system = 'urn:oid:2.16.840.1.113883.6.43.1').version.value"
            order="4"/>
        <attribute csv-column="Lokalisation" excel-column="Lokalisation"
            fhir-path="Condition.bodySite.coding.where(system = 'urn:oid:2.16.840.1.113883.6.43.1').code.value"
            order="5"/>
        <attribute csv-column="Seitenlokalisation nach ADT-GEKID"
            excel-column="Seitenlokalisation nach ADT-GEKID"
            fhir-path="Condition.bodySite.coding.where(system = 'urn:oid:2.16.840.1.113883.2.6.60.7.1.1').code.value"
            order="6"/>
        <attribute csv-column="Tumor Diagnosedatum" excel-column="Tumor Diagnosedatum"
            fhir-path="Condition.onset.value" order="7"/>
    </container>



    <container csv-filename="Histologie-${TIMESTAMP}.csv" excel-sheet="Histologie" order="60">
        <attribute csv-column="Histologie Datum" excel-column="Histologie Datum"
            fhir-path="Observation.where(code.coding.code = '59847-4').effective.value" order="1"/>
        <attribute csv-column="ICD-O Katalog Morphologie (Version)"
            excel-column="ICD-O Katalog Morphologie (Version)"
            fhir-path="Observation.where(code.coding.code = '59847-4').value.coding.version.value"
            order="2"/>
        <attribute csv-column="Morphologie" excel-column="Morphologie"
            fhir-path="Observation.where(code.coding.code = '59847-4').value.coding.code.value"
            order="3"/>
        <attribute csv-column="Morphologie-Freitext" excel-column="Morphologie-Freitext"
            fhir-path="Observation.where(code.coding.code = '59847-4').value.text.value" order="4"/>
    </container>


    <container csv-filename="Systemtherapie-${TIMESTAMP}.csv" excel-sheet="Systemtherapie" order="54">
        <attribute csv-column="Systemische Therapie Stellung zu operativer Therapie"
            excel-column="Systemische Therapie Stellung zu operativer Therapie"
            fhir-path="MedicationStatement.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-StellungZurOp').value.coding.code.value"
            order="1"/>
        <attribute csv-column="Intention Chemotherapie" excel-column="Intention Chemotherapie"
            fhir-path="MedicationStatement.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-SYSTIntention').value.coding.code.value"
            order="2"/>
        <attribute csv-column="Systemische Therapie Protokoll"
            excel-column="Systemische Therapie Protokoll"
            fhir-path="MedicationStatement.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-SystemischeTherapieProtokoll').value.text.value"
            order="3"/>
        <attribute csv-column="Therapieart" excel-column="Therapieart"
            fhir-path="MedicationStatement.category.coding.code.value" order="4"/>
        <attribute csv-column="Systemische Therapie Substanzen" excel-column=""
            fhir-path="MedicationStatement.medication.text.value" order="5"/>

        <attribute csv-column="Systemische Therapie Beginn"
            excel-column="Systemische Therapie Beginn"
            fhir-path="MedicationStatement.effective.start.value" order="6"/>
        <attribute csv-column="Systemische Therapie Ende" excel-column="Systemische Therapie Ende"
            fhir-path="MedicationStatement.effective.end.value" order="7"/>

        <attribute csv-column="Chemotherapie" excel-column="Chemotherapie"
            fhir-path="MedicationStatement.where(category.coding.code = 'CH').exists()" order="8"/>
        <attribute csv-column="Hormontherapie" excel-column="Hormontherapie"
            fhir-path="MedicationStatement.where(category.coding.code = 'HO').exists()" order="9"/>
        <attribute csv-column="Immuntherapie" excel-column="Immuntherapie"
            fhir-path="MedicationStatement.where(category.coding.code = 'IM').exists()" order="10"/>
        <attribute csv-column="Knochenmarktransplantation" excel-column="Knochenmarktransplantation"
            fhir-path="MedicationStatement.where(category.coding.code = 'KM').exists()" order="11"/>
        <attribute csv-column="Abwartende Strategie" excel-column="Abwartende Strategie"
            fhir-path="MedicationStatement.where(category.coding.code = 'WS').exists()" order="12"/>

    </container>


    <container csv-filename="Operation-${TIMESTAMP}.csv" excel-sheet="Operation" order="72">
        <attribute csv-column="OPS-Code" excel-column="OPS-Code"
            fhir-path="Procedure.where(category.coding.code = 'OP').code.coding.code.value"
            order="1"/>
        <attribute csv-column="Datum der OP" excel-column="Datum der OP"
            fhir-path="Procedure.where(category.coding.code = 'OP').performed.value" order="2"/>
        <attribute csv-column="Intention OP" excel-column="Intention OP"
            fhir-path="Procedure.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-OPIntention').value.coding.code.value"
            order="3"/>
        <attribute csv-column="OP" excel-column="OP"
            fhir-path="Procedure.where(category.coding.code = 'OP').exists()" order="4"/>
        <attribute csv-column="Lokale Beurteilung Resttumor"
            excel-column="Lokale Beurteilung Resttumor"
            fhir-path="Observation.where(code.coding.code = '84892-9').value.coding.code.value"
            order="1"/>
    </container>

    <container csv-filename="Strahlentherapie-${TIMESTAMP}.csv" excel-sheet="Strahlentherapie" order="73">
        <attribute csv-column="Strahlentherapie Stellung zu operativer Therapie"
            excel-column="Strahlentherapie Stellung zu operativer Therapie"
            fhir-path="Procedure.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-StellungZurOp').value.coding.code.value"
            order="1"/>
        <attribute csv-column="Intention Strahlentherapie" excel-column="Intention Strahlentherapie"
            fhir-path="Procedure.extension('http://dktk.dkfz.de/fhir/StructureDefinition/onco-core-Extension-SYSTIntention').value.coding.code.value"
            order="2"/>
        <attribute csv-column="Strahlentherapie Beginn" excel-column="Strahlentherapie Beginn"
            fhir-path="Procedure.where(category.coding.code = 'ST').performed.start.value" order="3"/>
        <attribute csv-column="Strahlentherapie Ende" excel-column="Strahlentherapie Ende"
            fhir-path="Procedure.where(category.coding.code = 'ST').performed.end.value" order="4"/>
        <attribute csv-column="Strahlentherapie Ende" excel-column="Strahlentherapie Ende"
            fhir-path="Procedure.where(category.coding.code = 'ST').exists()" order="5"/>
        
    </container>
    
    
    <container csv-filename="Progress-${TIMESTAMP}.csv" excel-sheet="Progress" order="72">
        <attribute csv-column="Ansprechen im Verlauf" excel-column="Ansprechen im Verlauf"
            fhir-path="Observation.where(code.coding.code = '21976-6').value.coding.code.value"
            order="1"/>
        <attribute csv-column="Datum lokales oder regionäres Rezidiv"
            excel-column="Datum lokales oder regionäres Rezidiv"
            fhir-path="Observation.where(code.coding.code = 'LA4583-6').effective.value" order="1"/>
        <attribute csv-column="Lokales bzw. regionäres Rezidiv"
            excel-column="Lokales bzw. regionäres Rezidiv"
            fhir-path="Observation.where(code.coding.code = 'LA4583-6').value.coding.code.value"
            order="2"/>
        
        <attribute csv-column="Fernmetastasen" excel-column="Fernmetastasen"
            fhir-path="Observation.where(code.coding.code = 'LA4226-2').value.coding.code.value"
            order="1"/>
        <attribute csv-column="Lymphknoten-Rezidiv" excel-column="Lymphknoten-Rezidiv"
            fhir-path="Observation.where(code.coding.code = 'LA4370-8').value.coding.code.value"
            order="1"/>
    </container>
    
   
    

    <container csv-filename="Fernmetastasen-${TIMESTAMP}.csv" excel-sheet="Fernmetastasen" order="55">
        <attribute csv-column="Datum diagnostischer Sicherung"
            excel-column="Datum diagnostischer Sicherung"
            fhir-path="Observation.where(code.coding.code = '21907-1').effective.value" order="1"/>
        <attribute csv-column="Fernmetastasen vorhanden" excel-column="Fernmetastasen vorhanden"
            fhir-path="Observation.where(code.coding.code = '21907-1').value.coding.code.value"
            order="2"/>
        <attribute csv-column="Lokalisation Fernmetastasen"
            excel-column="Lokalisation Fernmetastasen"
            fhir-path="Observation.where(code.coding.code = '21907-1').bodySite.coding.code.value"
            order="3"/>
    </container>

    <container csv-filename="GenetischeVariante-${TIMESTAMP}.csv" excel-sheet="GenetischeVariante" order="56">
        <attribute csv-column="Datum der Datenerhebung" excel-column="Datum der Datenerhebung"
            fhir-path="Observation.where(code.coding.code = '69548-6').effective.value" order="1"/>
        <attribute csv-column="Status des molekularen Markers"
            excel-column="Status des molekularen Markers"
            fhir-path="Observation.where(code.coding.code = '69548-6').value.coding.code.value"
            order="2"/>
        <attribute csv-column="Marker" excel-column=""
            fhir-path="Observation.where(code.coding.code = '69548-6').component.component.where(code.coding.code = '48018-6').value.coding.code.value"
            order="3"/>
    </container>

    <container csv-filename="GesamtbeurteilungResidualstatus-${TIMESTAMP}.csv"
        excel-sheet="GesamtbeurteilungResidualstatus" order="57">
        <attribute csv-column="Gesamtbeurteilung Resttumor"
            excel-column="Gesamtbeurteilung Resttumor"
            fhir-path="Observation.where(code.coding.code = '81169-5').value.coding.code.value"
            order="1"/>
    </container>



    <container csv-filename="Grading-${TIMESTAMP}.csv" excel-sheet="Grading" order="59">
        <attribute csv-column="Grading" excel-column="Grading"
            fhir-path="Observation.where(code.coding.code = '59542-1').value.coding.code.value"
            order="1"/>
    </container>


    <container csv-filename="TNMc-${TIMESTAMP}.csv" excel-sheet="TNMc" order="63">
        <attribute csv-column="Datum der TNM-Dokumentation/Datum Befund"
            excel-column="Datum der TNM-Dokumentation/Datum Befund"
            fhir-path="Observation.coding.where(code.coding.code = '21908-9').effective.value"
            order="1"/>
        <attribute csv-column="TNM-Version" excel-column="TNM-Version"
            fhir-path="Observation.coding.where(code.coding.code = '21908-9').value.coding.version.value"
            order="2"/>
        <attribute csv-column="UICC Stadium" excel-column="UICC Stadium"
            fhir-path="Observation.coding.where(code.coding.code = '21908-9').value.coding.code.value"
            order="3"/>
        <attribute csv-column="TNM-T" excel-column="TNM-T"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '21905-5').value.coding.code.value"
            order="4"/>
        <attribute csv-column="TNM-N" excel-column="TNM-N"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '21906-3').value.coding.code.value"
            order="5"/>
        <attribute csv-column="TNM-M" excel-column="TNM-M"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '21907-1').value.coding.code.value"
            order="6"/>
        <attribute csv-column="TNM-y-Symbol" excel-column="TNM-y-Symbol"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '59479-6').value.coding.code.value"
            order="7"/>
        <attribute csv-column="TNM-r-Symbol" excel-column="TNM-r-Symbol"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '21983-2').value.coding.code.value"
            order="8"/>
        <attribute csv-column="TNM-m-Symbol" excel-column="TNM-m-Symbol"
            fhir-path="Observation.where(code.coding.code = '21908-9').component.where(code.coding.code = '42030-7').value.coding.code.value"
            order="9"/>
    </container>


    <container csv-filename="TNMp-${TIMESTAMP}.csv" excel-sheet="TNMp" order="64">
        <attribute csv-column="Datum der TNM-Dokumentation/Datum Befund"
            excel-column="Datum der TNM-Dokumentation/Datum Befund"
            fhir-path="Observation.coding.where(code.coding.code = '21902-2').effective.value"
            order="1"/>
        <attribute csv-column="TNM-Version" excel-column="TNM-Version"
            fhir-path="Observation.coding.where(code.coding.code = '21902-2').value.coding.version.value"
            order="2"/>
        <attribute csv-column="UICC Stadium" excel-column="UICC Stadium"
            fhir-path="Observation.coding.where(code.coding.code = '21902-2').value.coding.code.value"
            order="3"/>
        <attribute csv-column="TNM-T" excel-column="TNM-T"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '21899-0').value.coding.code.value"
            order="4"/>
        <attribute csv-column="TNM-N" excel-column="TNM-N"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '21900-6').value.coding.code.value"
            order="5"/>
        <attribute csv-column="TNM-M" excel-column="TNM-M"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '21901-4').value.coding.code.value"
            order="6"/>
        <attribute csv-column="TNM-y-Symbol" excel-column="TNM-y-Symbol"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '59479-6').value.coding.code.value"
            order="7"/>
        <attribute csv-column="TNM-r-Symbol" excel-column="TNM-r-Symbol"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '21983-2').value.coding.code.value"
            order="8"/>
        <attribute csv-column="TNM-m-Symbol" excel-column="TNM-m-Symbol"
            fhir-path="Bundle.entry.select(resource as Observation).where(code.coding.code = '21902-2').component.where(code.coding.code = '42030-7').value.coding.code.value"
            order="9"/>
    </container>

    <container csv-filename="TodUrsache-${TIMESTAMP}.csv" excel-sheet="TodUrsache" order="65">
        <attribute csv-column="Tod tumorbedingt" excel-column="Tod tumorbedingt"
            fhir-path="Observation.where(code.coding.code = '68343-3').value.coding.where(system = 'http://fhir.de/CodeSystem/bfarm/icd-10-gm').code.value"
            order="1"/>
        <attribute csv-column="Todesursachen" excel-column="Todesursachen"
            fhir-path="Observation.where(code.coding.code = '68343-3').value.coding.where(system = 'http://dktk.dkfz.de/fhir/onco/core/CodeSystem/JNUCS').code.value"
            order="2"/>
    </container>


    <!-- to integrate -->
    <container csv-filename="TNMcpuPraefix-${TIMESTAMP}.csv" excel-sheet="TNMcpuPraefix" order="53">
        <attribute csv-column="c/p/u Praefix" excel-column="c/p/u Praefix"
            fhir-path="Extension.value.coding.code.value" order="1"/>
    </container>

</template>
